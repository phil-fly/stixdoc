### “三问题规则”和四个主要属性

#### 威胁情报的“三问题规则”

所有威胁情报都应解决三个问题，使客户能够快速确定其组织的相关性和影响，然后在必要时立即采取行动。

- 威胁（Threat）- 威胁是什么？who, what where, when why 和how。

- 影响（Impact）- 对组织的影响是什么？

- 行动（Action，可执行的建议）- 哪些行动可以缓解近期和中期的威胁？

威胁情报通过定义上下文来解决这些问题。谁应该关注威胁和原因，以及通过定义要采取的行动 – 如何保护和防御它。在没有上下文的情况下，威胁情报缺乏支持决策的必要描述性元素，例如检测优先级或威胁与环境的相关性。如果没有采取行动，威胁情报对于组织而言往往毫无用处。



#### 威胁情报上下文

威胁情报上下文提供围绕任何威胁的必要相关性。

威胁情报上下文通常包括：

- 每个钻石模型（Diamond Model）特征的描述

- 整个杀伤链（Kill Chain）中对手行为的描述

- 技术说明，包括网络活动，恶意软件分析以及主机和日志活动

- 对熟悉的操作环境进行影响评估，方案和风险分析

- 进一步研究的重要参考资料



威胁情报上下文示例：

```
影响：高

行业：电力传输

2018年12月10日至30日期间，几家涉及电力传输的公用事业公司受到鱼叉式网络钓鱼电子邮件攻击。这些电子邮件包含一个恶意Word文档，在未打安全补丁的电脑上成功利用漏洞MS08-067，然后开始通过SMBv1在网络中传播类似蠕虫的活动，进行横向移动。该蠕虫主动寻找历史学家的应用以及涉及电力传输的运营网络的其他证据。

一旦蠕虫发现了运营网络的证据，蠕虫就会通过HTTPS向IP X.X.X.X联系命令和控制服务器。然后，攻击者将使用蠕虫的远程访问功能访问网络，并使用本地PowerShell资源开始进一步的内部侦察。

该威胁主要针对电力传输行业，因此可能与该行业以外的组织无关。但是，不排除攻击者会攻击其他行业，因此我们建议网络维护者或运营商根据我们上面提供的技术细节，进行自检，以防止将来对其网络的此类攻击。



参考资料：xxx

威胁情报行动（可执行的建议）
```



**威胁情报行动**提供针对威胁行为和影响而定制的技术和方案建议。行动的范围从检测和猎杀的技术细节到对公司管理层有用的最具战略性的洞见。

威胁情报行动通常包括：

- 检测指导，如失陷指标（IOCs）或签名（signatures），以支持识别入侵行为

- 保护组织免受潜在威胁的指导方案

- 详细的威胁行为，以寻找类似的行为

- 支持有效检测的数据收集建议

- 威胁范围和影响细节支持基于风险的战略决策



威胁情报行动示例：

```
在2017年7月10日至8月30日期间检测并防止与IP地址X.X.X.X相关的任何入站或出站网络活动，因为它被用作恶意活动的命令和控制。

安装MS08-067补丁，以防止被攻击者利用。

屏蔽IT和运营网络之间的SMBv1通信，以防止蠕虫的潜在传播。如果SMBv1是业务运营所必需的，我们建议运营网络限制除必要位置之外的所有SMBv1活动/流量。

进入受害者网络后，攻击者会利用Windows PowerShell进行进一步的渗透-我们建议监视所有PowerShell活动以查找与所述活动相关的行为，并在不需要的所有主机上禁用PowerShell。

由于这种威胁对运营的影响很大（包括电力传输损失），建议与该活动有关的每个组织优先考虑此威胁。
```





#### 威胁情报的四个主要属性

好的威胁情报必须具备四个属性：完整性（completeness），准确性（accuracy），相关性（relevance）和及时性（timeliness）。

- 完整性（completeness）：威胁情报必须提供足够的细节以实现正确的响应，如主机取证，恶意软件分析，漏洞分析，网络流量分析和日志分析。

- 准确性（accuracy）：这对应着我们一般说的误报率指标。

- 相关性（relevance）：强调和具体用户的地域性、行业性相关，即需要针对此用户的环境，能发现可能遭遇的重要威胁。

- 及时性或时效性（timeliness）：情报的及时性是由多个因素构成的，从数据收集，云端处理到情报分发（即收集、处理和分发的及时性）。另外，情报不仅需要标记生成时间而且需要标注持续时间。情报的域名拥有者、IP使用者和其上的业务，随着时间的推移，可能产生变化，黑IP会变成白IP。

